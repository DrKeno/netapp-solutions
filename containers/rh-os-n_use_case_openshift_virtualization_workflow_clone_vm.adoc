---
sidebar: sidebar
permalink: containers/rh-os-n_use_case_openshift_virtualization_workflow_clone_vm.html
keywords: OpenShift, OCP, NetApp Trident, NetApp ONTAP, Red Hat OpenShift, OpenShift Virtualization, CNV, Container Native Virtualization, Red Hat OpenShift Virtualization
summary: Red Hat OpenShift Virtualization with NetApp
---

= Workflows: Red Hat OpenShift Virtualization with NetApp

:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./../media/

[.lead]

== VM Cloning

Cloning an existing VM in OpenShift is achieved with the support of NetApp Trident’s Volume CSI cloning feature. CSI volume cloning allows for creation of a new PVC using an existing PVC as the data source by duplicating its PV. Once the new PVC is created, it functions as a separate entity and without any link or dependency to the source PVC.

image::redhat_openshift_image57.jpg[VM Cloning architecture]

There are certain restrictions with the CSI Volume cloning that need to considered –

.	Source PVC and Destination PVC must be in the same project.
.	Cloning is supported within the same Storage Class.
.	Cloning can be performed only when source and destination volumes use the same VolumeMode setting i.e. block volume can be cloned to another block volume only.

VMs in an OpenShift cluster can be cloned in two ways –

.	By shutting down the source VM
.	By keeping the source VM live

==== By Shutting down the source VM

Cloning an existing VM by shutting down the VM is OpenShift’s in-built feature and is implemented with support from NetApp Trident. Follow the below steps to clone a VM -

.	Navigate to Workloads -> Virtualization -> Virtual Machines and click on ellipsis next to the virtual machine you wish to clone.
.	Click on ‘Clone Virtual Machine’ and provide the details for the new VM.
+

image::redhat_openshift_image58.jpg[clone vm]

.	Click on ‘Clone Virtual Machine’, this will shut down the source VM and initiate the creation of the clone VM.
.	Once completed, you can access and verify the content of the cloned VM.

==== By keeping the source VM live

An existing VM can also be cloned by cloning the existing PVC of the source VM and then creating a new VM using the cloned PVC. This method does not require you to shut down the source VM. Follow the below steps to clone a VM without shutting it down:

.	Navigate to Storage -> PersistentVolumeClaims and click on the ellipsis next to the PVC that is attached to the source VM.
.	Click on ‘Clone PVC’ and furnish the details for the new PVC.
+

image::redhat_openshift_image59.jpg[clone pvc]

.	Then click on ‘Clone’. This creates a PVC for the new VM.
.	Navigate to Workloads -> Virtualization -> Virtual Machines and click on Create -> With YAML.
.	In the spec -> template -> spec -> volumes section, attach the cloned PVC instead of container disk. Provide all other details for the new VM as per the requirement.
[source, cli]
- name: rootdisk
  persistentVolumeClaim:
    claimName: rhel8-short-frog-rootdisk-28dvb-clone

.	Click on ‘Create’ to create the new VM.
.	Once the VM is created successfully, access and verify that the new VM is a clone of the source VM.

link:rh-os-n_use_case_openshift_virtualization_workflow_vm_from_snapshot.html[Next: Workflows: Create VM from a Snapshot]
